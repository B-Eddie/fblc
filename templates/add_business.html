{% extends "base.html" %} {% block content %}
<h1 class="mb-8 text-3xl font-bold text-orange-600">Add Your Business</h1>

<form method="POST" class="px-8 pt-6 pb-8 mb-4 rounded shadow-md bg-accent">
  {{ form.csrf_token }}
  <div class="mb-4">
    <label class="block mb-2 text-sm font-bold text-gray-700" for="name">
      Business Name
    </label>
    <input
      class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"
      id="name"
      name="name"
      type="text"
      placeholder="HealthCare Clinic"
      required
    />
  </div>
  <div class="mb-4">
    <label class="block mb-2 text-sm font-bold text-gray-700" for="specialty">
      Specialty
    </label>
    <input
      class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"
      id="specialty"
      name="specialty"
      type="text"
      placeholder="General Practice"
      required
    />
  </div>
  <div class="mb-4">
    <label class="block mb-2 text-sm font-bold text-gray-700" for="address">
      Address
    </label>
    <div class="relative">
      <input
        class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"
        id="address"
        name="address"
        type="text"
        placeholder="Start typing an address..."
        autocomplete="off"
        required
      />
      <div
        id="suggestions"
        class="absolute z-10 hidden w-full mt-1 bg-white border rounded-md shadow-lg"
      ></div>
    </div>
  </div>
  <div class="mb-6">
    <label class="block mb-2 text-sm font-bold text-gray-700" for="phone">
      Phone Number
    </label>
    <input
      class="w-full px-3 py-2 leading-tight text-gray-700 border rounded shadow appearance-none focus:outline-none focus:shadow-outline"
      id="phone"
      name="phone"
      type="tel"
      placeholder="123-456-7890"
      required
    />
  </div>
  <div class="flex items-center justify-between">
    <button
      class="px-4 py-2 font-bold text-black transition duration-300 bg-orange-500 rounded hover:bg-orange-600 focus:outline-none focus:shadow-outline"
      type="submit"
    >
      Add Business
    </button>
  </div>
</form>

<div
  class="p-4 mb-4 text-orange-700 bg-orange-100 border-l-4 border-orange-500"
  role="alert"
>
  <p class="font-bold">Note:</p>
  <p>
    Your business will be reviewed for verification before it appears in the
    provider list. This process may take a few business days.
  </p>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const platform = new H.service.Platform({
      apikey: "lUFTE1skWuIcrj_s0wCZbbM2KWcgT2JnJcKGWHFi4WA", // Replace with your HERE API key
    });

    const addressInput = document.getElementById("address");
    const suggestionsList = document.getElementById("suggestions");
    let timeout = null;

    addressInput.addEventListener("input", function () {
      clearTimeout(timeout);
      timeout = setTimeout(() => {
        const query = this.value;
        if (query.length < 3) {
          suggestionsList.classList.add("hidden");
          return;
        }

        const service = platform.getSearchService();
        service.autosuggest(
          {
            q: query,
            maxresults: 5,
          },
          (result) => {
            suggestionsList.innerHTML = "";
            suggestionsList.classList.remove("hidden");

            result.items.forEach((item) => {
              const div = document.createElement("div");
              div.className = "px-4 py-2 cursor-pointer hover:bg-gray-100";
              div.textContent = item.address.label;
              div.addEventListener("click", () => {
                addressInput.value = item.address.label;
                suggestionsList.classList.add("hidden");
              });
              suggestionsList.appendChild(div);
            });
          },
          alert
        );
      }, 300);
    });

    // Hide suggestions when clicking outside
    document.addEventListener("click", function (e) {
      if (
        !addressInput.contains(e.target) &&
        !suggestionsList.contains(e.target)
      ) {
        suggestionsList.classList.add("hidden");
      }
    });
  });
</script>
{% endblock %}
