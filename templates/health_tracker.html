{% extends "base.html" %}

{% block content %}
<h1 class="text-3xl font-bold text-orange-600 mb-8">Health Tracker</h1>

<div class="grid md:grid-cols-2 gap-8">
    <div class="bg-white shadow-lg rounded-lg border border-orange-200 p-4">
        <h2 class="text-xl font-semibold text-orange-700 mb-4">Add Today's Health Data</h2>
        <form method="POST" action="{{ url_for('add_health_data') }}">
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="steps">
                    Steps
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="steps" name="steps" type="number" required>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="calories">
                    Calories Burned
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="calories" name="calories" type="number" required>
            </div>
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="sleep_hours">
                    Sleep Hours
                </label>
                <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="sleep_hours" name="sleep_hours" type="number" step="0.1" required>
            </div>
            <button class="bg-orange-600 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300" type="submit">
                Add Data
            </button>
        </form>
    </div>

    <div class="bg-white shadow-lg rounded-lg border border-orange-200 p-4">
        <h2 class="text-xl font-semibold text-orange-700 mb-4">Health Data Visualization</h2>
        <canvas id="healthChart"></canvas>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    fetch('/api/health_data')
        .then(response => response.json())
        .then(data => {
            const ctx = document.getElementById('healthChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: data.map(item => item.date),
                    datasets: [{
                        label: 'Steps',
                        data: data.map(item => item.steps),
                        borderColor: 'rgb(255, 99, 132)',
                        tension: 0.1
                    }, {
                        label: 'Calories',
                        data: data.map(item => item.calories),
                        borderColor: 'rgb(54, 162, 235)',
                        tension: 0.1
                    }, {
                        label: 'Sleep Hours',
                        data: data.map(item => item.sleep_hours),
                        borderColor: 'rgb(75, 192, 192)',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        });
});
</script>
{% endblock %}

